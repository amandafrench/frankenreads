jQuery(document).ready(function(e){var o={location_fields:["lat","lng","address","formatted_address","street","city","region_name","region_code","postcode","country_name","country_code"],messages:{geocoder_failed:"Geocoder failed due to: ",no_address:"Please enter an address."},object_id:!1,ajax:{},init:function(){jQuery(".gmw-cl-form-trigger").click(function(e){e.preventDefault(),jQuery(this).closest(".gmw-cl-form-wrapper").find("form").slideToggle()}),jQuery(".gmw-cl-clear-location-trigger").click(function(e){e.preventDefault(),o.object_id=jQuery(this).closest(".gmw-cl-form-wrapper").data("element-id"),o.delete_location()}),jQuery(".gmw-cl-locator-trigger").click(function(e){e.preventDefault(),o.object_id=jQuery(this).closest("form").data("element-id"),jQuery(".gmw-cl-address-input").prop("readonly",!0),jQuery(".gmw-cl-form-submit").removeClass("gmw-icon-search").addClass("gmw-icon-spin-light animate-spin");var r=jQuery("#gmw-cl-message-"+o.object_id).data("loading_message");0!=r&&0!==r.length&&jQuery("#gmw-cl-respond-wrapper-"+o.object_id).slideDown("fast",function(){jQuery("#gmw-cl-message-"+o.object_id).addClass("locating").html(r)}),GMW.auto_locator("cl_locator",o.auto_locator_success,o.geocoder_failed)}),jQuery(".gmw-cl-address-input").bind("keypress",function(e){13==e.keyCode&&jQuery(this).closest("form").find(".gmw-cl-form-submit").click()}),jQuery(".gmw-cl-form-submit").click(function(e){if(e.preventDefault(),o.object_id=jQuery(this).closest("form").data("element-id"),0===jQuery("#gmw-cl-address-input-"+o.object_id).val().length)return alert(o.messages.no_address),!1;jQuery(".gmw-cl-address-input").prop("readonly",!0),jQuery(".gmw-cl-form-submit").removeClass("gmw-icon-search").addClass("gmw-icon-spin-light animate-spin");var r=jQuery("#gmw-cl-message-"+o.object_id).data("loading_message");0!=r&&0!==r.length&&jQuery("#gmw-cl-respond-wrapper-"+o.object_id).slideDown("fast",function(){jQuery("#gmw-cl-message-"+o.object_id).addClass("locating").html(r)});var s=jQuery("#gmw-cl-address-input-"+o.object_id).val();GMW.geocoder(s,o.address_geocoder_success,o.geocoder_failed)})},delete_location:function(e){jQuery.each(o.location_fields,function(e,o){GMW.delete_cookie("gmw_ul_"+o)}),jQuery(".gmw-cl-address .address-holder").html(""),jQuery(".gmw-cl-element.gmw-cl-address-wrapper").slideUp(),jQuery(".gmw-map-wrapper.current_location").fadeOut(),jQuery(".gmw-cl-form-trigger, .gmw-cl-clear-location-trigger").slideUp(),jQuery(".gmw-cl-form").slideDown()},save_location:function(){o.ajax=jQuery.ajax({type:"POST",url:gmwAjaxUrl,dataType:"json",data:{action:"gmw_update_current_location",form_values:jQuery("#gmw-current-location-hidden-form").serialize(),security:gmw_cl_nonce},success:function(e){if("undefined"!=typeof GMW_Maps&&"undefined"!=typeof GMW_Maps[o.object_id]){var r=o.object_id,s=new google.maps.LatLng(e.lat,e.lng);GMW_Maps[r].user_marker.setPosition(s),GMW_Maps[r].map.panTo(s)}newAddress=jQuery("#gmw-cl-address-input-"+o.object_id).val(),jQuery(".gmw-cl-address .address-holder").html(newAddress)}}).fail(function(e){window.console&&window.console.log&&(e.responseText&&console.log(e.responseText),console.log(e))}),o.ajax.done(function(e){setTimeout(function(){jQuery(".gmw-cl-respond-wrapper").slideUp(),jQuery(".gmw-cl-address-input").prop("readonly",!1),jQuery(".gmw-cl-form-submit").removeClass("gmw-icon-spin-light animate-spin").addClass("gmw-icon-search")},500)})},submit_location:function(){setTimeout(function(){1==jQuery("#gmw-cl-form-wrapper-"+o.object_id).data("ajax_enabled")?o.save_location():jQuery("#gmw-current-location-hidden-form").submit()},3500)},auto_locator_success:function(e){jQuery("#gmw-cl-address-input-"+o.object_id).val(e.formatted_address),o.submit_location()},address_geocoder_success:function(e){GMW.save_location_fields(e),o.submit_location()},geocoder_failed:function(e){jQuery("#gmw-cl-respond-wrapper-"+o.object_id).slideDown(function(){jQuery("#gmw-cl-message-"+o.object_id).addClass("error").html(o.messages.geocoder_failed+e)}),setTimeout(function(){jQuery(".gmw-cl-respond-wrapper").slideUp(),jQuery(".gmw-cl-message").removeClass("error").html(""),jQuery(".gmw-cl-address-input").prop("readonly",!1),jQuery(".gmw-cl-form-submit").removeClass("gmw-icon-spin-light animate-spin").addClass("gmw-icon-search")},3e3)}};o.init()});