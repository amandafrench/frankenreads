var tribe_community_events=tribe_community_events||{};!function(i,r,s){"use strict";s.$window=r(i),s.$datepickers=r(),s.$timepickers=r(),s.els={uploadArea:document.querySelector(".tribe-image-upload-area"),uploadFile:document.getElementById("uploadFile"),eventImage:document.getElementById("EventImage"),detachThumbnail:document.getElementById("tribe-events-community-detach-thumbnail")},s.date_to_ymd=function(e){var t=e.getDate(),i=e.getMonth()+1;return e.getFullYear()+"-"+(i<=9?"0"+i:i)+"-"+(t<=9?"0"+t:t)},s.init_linked_posts_handle=function(){var e=r(".move-linked-post-group"),t=r(".saved-linked-post");e.addClass("hidden"),t.on("change",function(){r(t).closest(e).removeClass("hidden"),r(this).find(e).removeClass("hidden")})},s.init_mobile_datetime_input=function(){s.$datepickers=r("#EventStartDate, #EventEndDate"),s.$timepickers=r("#EventStartTime, #EventEndTime"),s.$window.on({"resize.tribe":function(){s.$window.width()<=568?(s.$datepickers.on("change.tribe",s.on_change_datepicker).trigger("change"),void 0!==r.fn.tribeTimepicker?s.$timepickers.tribeTimepicker("option","disableTouchKeyboard",!0):s.$timepickers.timepicker("option","disableTouchKeyboard",!0)):(s.$datepickers.prop("type","text"),s.$datepickers.off("change.tribe"),void 0!==r.fn.tribeTimepicker?s.$timepickers.tribeTimepicker("option","disableTouchKeyboard",!1):s.$timepickers.timepicker("option","disableTouchKeyboard",!1))},load:function(){s.$window.trigger("resize.tribe")}})},s.on_change_datepicker=function(){var e=r(this),t=s.$datepickers.not(e),i="start",n=r(this).data("datepicker"),a=r.datepicker.parseDate(n.settings.dateFormat||r.datepicker._defaults.dateFormat,e.val(),n.settings),o=r.datepicker.parseDate(n.settings.dateFormat||r.datepicker._defaults.dateFormat,t.val(),n.settings);"EventEndDate"!==e.attr("name")&&"EventEndDate"!==e.attr("id")||(i="end"),"start"===i?(t.attr("min",s.date_to_ymd(a)),o<a&&t.val(s.date_to_ymd(a))):a<o&&t.val(s.date_to_ymd(a))},s.init_local_storage=function(){i.localStorage&&r(".tribe-toggle-column").on("change",function(){var e=r(this),t=e.attr("id");i.localStorage.getItem(t);e.is(":checked")?i.localStorage.removeItem(t):i.localStorage.setItem(t,"1")}).each(function(){var e=r(this),t=e.attr("id");i.localStorage.getItem(t)&&e.prop("checked",!1).trigger("change")})},s.init_image_input=function(){var e=r(s.els.uploadArea);r(s.els.eventImage).on("change",function(){var e=this.value.split("\\").pop();s.els.uploadArea.classList.add("uploaded"),s.els.detachThumbnail.setAttribute("value",!1),s.els.uploadFile.setAttribute("value",e),s.els.uploadFile.setAttribute("size",e.length)}),e.on("click",".tribe-remove-upload a",function(e){e.preventDefault(),s.removeEventImage()}),e.on("click",".submitdelete",function(e){e.preventDefault(),s.removeEventImage(),s.detachThumbnail()})},s.removeEventImage=function(){s.els.uploadArea.classList.remove("uploaded"),s.els.uploadArea.classList.remove("has-image"),s.els.uploadFile.setAttribute("value",""),s.els.eventImage.setAttribute("value","")},s.detachThumbnail=function(){s.els.detachThumbnail.setAttribute("value",!0)},s.init_list_columns_menu=function(){var t=r(".table-menu");r(".table-menu-btn").click(function(){return r(this).toggleClass("menu-open").parent().find(".table-menu").toggleClass("table-menu-hidden"),!1}),r(document).click(function(e){r(e.target).is(t)||r(e.target).is(r(t).find("*"))||r(t).addClass("table-menu-hidden")})},s.remove_no_js_class=function(){r(document.getElementById("tribe-events")).removeClass("tribe-no-js").addClass("tribe-js")},s.setup_dropdowns=function(){r(".tribe-dropdown").trigger("change")},s.datetime_selectors=function(){"object"==typeof tribe_dynamic_helper_text&&tribe_dynamic_helper_text.event_date_change()},s.is_creating_linked_posts=function(){return 0<r("#tribe-community-events form").find(".tribe-is-creating-linked-post").length},s.is_form_field_empty=function(e,t){for(var i=0;i<t.length;i++)if(e==t[i].name)return""===t[i].value;return!1},s.add_js_form_errors=function(e){var t=r("#tribe-community-events");t.find(".tribe-community-js-notice").remove();var i=r("<div />",{class:"tribe-community-notice tribe-community-js-notice tribe-community-notice-error"});i.insertBefore(t.find("form"));for(var n=0;n<e.length;n++)"post_title"===e[n]&&r("<p />",{text:tribe_submit_form_i18n.errors.post_title}).appendTo(i),"tcepostcontent"===e[n]&&r("<p />",{text:tribe_submit_form_i18n.errors.tcepostcontent}).appendTo(i)},s.disallow_submission_while_creating_linked_posts=function(){r("#tribe-community-events form").on("submit",function(e){var t=r(this).serializeArray(),i=s.is_form_field_empty("post_title",t),n=s.is_form_field_empty("tcepostcontent",t),a=[];return i&&a.push("post_title"),n&&a.push("tcepostcontent"),!(s.is_creating_linked_posts()&&0<a.length)||((i||n)&&s.add_js_form_errors(a),!1)})},r(document).ready(s.init_mobile_datetime_input).ready(s.init_image_input).ready(s.init_list_columns_menu).ready(s.init_local_storage).ready(s.init_linked_posts_handle).ready(s.remove_no_js_class).ready(s.remove_no_js_class).ready(s.setup_dropdowns).ready(s.datetime_selectors).ready(s.disallow_submission_while_creating_linked_posts)}(window,jQuery,tribe_community_events);